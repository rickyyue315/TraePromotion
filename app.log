2025-10-11 16:50:32,564 - ERROR - Demand calculation error: "Column(s) ['SKU_Total_Demand', 'Total_Dispatch', 'Total_Pending', 'Total_Stock'] do not exist"
Traceback (most recent call last):
  File "C:\Users\BestO\AI\Sep2025_App\Trea Promotion_v1\app.py", line 209, in calculate_demand
    summary = df_calc.groupby(['Group No.', 'Site']).agg(summary_agg).reset_index()
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\groupby\generic.py", line 1432, in aggregate
    result = op.agg()
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 190, in agg
    return self.agg_dict_like()
           ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 1603, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ~~~~~~~~~~~~~~~~~~~~~~^
        op_name, selected_obj, selection, kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['SKU_Total_Demand', 'Total_Dispatch', 'Total_Pending', 'Total_Stock'] do not exist"
2025-10-11 16:50:35,976 - ERROR - Demand calculation error: "Column(s) ['SKU_Total_Demand', 'Total_Dispatch', 'Total_Pending', 'Total_Stock'] do not exist"
Traceback (most recent call last):
  File "C:\Users\BestO\AI\Sep2025_App\Trea Promotion_v1\app.py", line 209, in calculate_demand
    summary = df_calc.groupby(['Group No.', 'Site']).agg(summary_agg).reset_index()
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\groupby\generic.py", line 1432, in aggregate
    result = op.agg()
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 190, in agg
    return self.agg_dict_like()
           ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 1603, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ~~~~~~~~~~~~~~~~~~~~~~^
        op_name, selected_obj, selection, kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['SKU_Total_Demand', 'Total_Dispatch', 'Total_Pending', 'Total_Stock'] do not exist"
2025-10-11 17:00:05,802 - ERROR - Demand calculation error: 'D001_In_Quality_Insp.'
Traceback (most recent call last):
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'D001_In_Quality_Insp.'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BestO\AI\Sep2025_App\Trea Promotion_v1\app.py", line 233, in calculate_demand
    summary_final[col] = summary_final[col].fillna(0).astype(int)
                         ~~~~~~~~~~~~~^^^^^
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\frame.py", line 4107, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\BestO\AppData\Roaming\Python\Python313\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'D001_In_Quality_Insp.'
